{"ast":null,"code":"import { Region } from '../interfaces/country.interface';\nimport { combineLatest, map, of, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CountriesService {\n  constructor(httpClient) {\n    this.httpClient = httpClient;\n    this.baseUrl = 'https://restcountries.com/v3.1';\n    this._regions = [Region.Africa, Region.Americas, Region.Asia, Region.Europe, Region.Oceania];\n  }\n  get regions() {\n    return [...this._regions];\n  }\n  getCountriesByRegion(region) {\n    if (!region) return of([]);\n    const url = `${this.baseUrl}/region/${region}/?fields=cca3,name,borders`;\n    return this.httpClient.get(url).pipe(map(countries => countries.map(country => ({\n      name: country.name.common,\n      cca3: country.cca3,\n      borders: country.borders || []\n      // borders: country.borders ?? []\n    }))), tap(response => console.log({\n      response\n    })));\n  }\n  getCountryByAlphaCode(alphaCode) {\n    console.log({\n      alphaCode\n    });\n    const url = `${this.baseUrl}/alpha/${alphaCode}?fields=cca3,name,borders`;\n    return this.httpClient.get(url).pipe(map(country => ({\n      name: country.name.common,\n      cca3: country.cca3,\n      borders: country.borders ?? []\n    })));\n  }\n  getCountryBordersByCodes(borders) {\n    if (!borders || borders.length === 0) return of([]);\n    const countryRequest = [];\n    borders.forEach(code => {\n      const request = this.getCountryByAlphaCode(code);\n      countryRequest.push(request);\n    });\n    return combineLatest(countryRequest);\n  }\n  static #_ = this.ɵfac = function CountriesService_Factory(t) {\n    return new (t || CountriesService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CountriesService,\n    factory: CountriesService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["Region","combineLatest","map","of","tap","CountriesService","constructor","httpClient","baseUrl","_regions","Africa","Americas","Asia","Europe","Oceania","regions","getCountriesByRegion","region","url","get","pipe","countries","country","name","common","cca3","borders","response","console","log","getCountryByAlphaCode","alphaCode","getCountryBordersByCodes","length","countryRequest","forEach","code","request","push","_","i0","ɵɵinject","i1","HttpClient","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\luisr\\Documents\\Develop\\Curso Angular - Fernando Herrera 2023\\Angular\\selectores\\src\\app\\countries\\services\\countries.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Country, Region, SmallCountry } from '../interfaces/country.interface';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, combineLatest, map, of, tap } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CountriesService {\n\n  private baseUrl: string = 'https://restcountries.com/v3.1';\n\n  private _regions: Region[] = [\n    Region.Africa,\n    Region.Americas,\n    Region.Asia,\n    Region.Europe,\n    Region.Oceania,\n  ]\n\n  constructor(private httpClient: HttpClient) { }\n\n  get regions(): Region[] {\n    return [...this._regions];\n  }\n\n  getCountriesByRegion(region: Region): Observable<SmallCountry[]> {\n    if (!region) return of([]);\n\n    const url: string = `${this.baseUrl}/region/${region}/?fields=cca3,name,borders`;\n\n    return this.httpClient.get<Country[]>(url)\n      .pipe(\n        map(countries => countries.map(country => ({\n          name: country.name.common,\n          cca3: country.cca3,\n          borders: country.borders || []\n          // borders: country.borders ?? []\n        }))),\n        tap(response => console.log({ response }))\n      )\n  }\n\n  getCountryByAlphaCode(alphaCode: string): Observable<SmallCountry> {\n\n    console.log({ alphaCode });\n\n    const url = `${this.baseUrl}/alpha/${alphaCode}?fields=cca3,name,borders`;\n    return this.httpClient.get<Country>(url)\n      .pipe(\n        map(country => ({\n          name: country.name.common,\n          cca3: country.cca3,\n          borders: country.borders ?? []\n        }))\n      )\n  }\n\n  getCountryBordersByCodes(borders: string[]): Observable<SmallCountry[]> {\n    if (!borders || borders.length === 0) return of([]);\n\n    const countryRequest: Observable<SmallCountry>[] = [];\n\n    borders.forEach(code => {\n      const request = this.getCountryByAlphaCode(code);\n      countryRequest.push(request);\n    })\n\n    return combineLatest(countryRequest);\n\n  }\n}\n"],"mappings":"AACA,SAAkBA,MAAM,QAAsB,iCAAiC;AAE/E,SAAqBC,aAAa,EAAEC,GAAG,EAAEC,EAAE,EAAEC,GAAG,QAAQ,MAAM;;;AAK9D,OAAM,MAAOC,gBAAgB;EAY3BC,YAAoBC,UAAsB;IAAtB,KAAAA,UAAU,GAAVA,UAAU;IAVtB,KAAAC,OAAO,GAAW,gCAAgC;IAElD,KAAAC,QAAQ,GAAa,CAC3BT,MAAM,CAACU,MAAM,EACbV,MAAM,CAACW,QAAQ,EACfX,MAAM,CAACY,IAAI,EACXZ,MAAM,CAACa,MAAM,EACbb,MAAM,CAACc,OAAO,CACf;EAE6C;EAE9C,IAAIC,OAAOA,CAAA;IACT,OAAO,CAAC,GAAG,IAAI,CAACN,QAAQ,CAAC;EAC3B;EAEAO,oBAAoBA,CAACC,MAAc;IACjC,IAAI,CAACA,MAAM,EAAE,OAAOd,EAAE,CAAC,EAAE,CAAC;IAE1B,MAAMe,GAAG,GAAW,GAAG,IAAI,CAACV,OAAO,WAAWS,MAAM,4BAA4B;IAEhF,OAAO,IAAI,CAACV,UAAU,CAACY,GAAG,CAAYD,GAAG,CAAC,CACvCE,IAAI,CACHlB,GAAG,CAACmB,SAAS,IAAIA,SAAS,CAACnB,GAAG,CAACoB,OAAO,KAAK;MACzCC,IAAI,EAAED,OAAO,CAACC,IAAI,CAACC,MAAM;MACzBC,IAAI,EAAEH,OAAO,CAACG,IAAI;MAClBC,OAAO,EAAEJ,OAAO,CAACI,OAAO,IAAI;MAC5B;KACD,CAAC,CAAC,CAAC,EACJtB,GAAG,CAACuB,QAAQ,IAAIC,OAAO,CAACC,GAAG,CAAC;MAAEF;IAAQ,CAAE,CAAC,CAAC,CAC3C;EACL;EAEAG,qBAAqBA,CAACC,SAAiB;IAErCH,OAAO,CAACC,GAAG,CAAC;MAAEE;IAAS,CAAE,CAAC;IAE1B,MAAMb,GAAG,GAAG,GAAG,IAAI,CAACV,OAAO,UAAUuB,SAAS,2BAA2B;IACzE,OAAO,IAAI,CAACxB,UAAU,CAACY,GAAG,CAAUD,GAAG,CAAC,CACrCE,IAAI,CACHlB,GAAG,CAACoB,OAAO,KAAK;MACdC,IAAI,EAAED,OAAO,CAACC,IAAI,CAACC,MAAM;MACzBC,IAAI,EAAEH,OAAO,CAACG,IAAI;MAClBC,OAAO,EAAEJ,OAAO,CAACI,OAAO,IAAI;KAC7B,CAAC,CAAC,CACJ;EACL;EAEAM,wBAAwBA,CAACN,OAAiB;IACxC,IAAI,CAACA,OAAO,IAAIA,OAAO,CAACO,MAAM,KAAK,CAAC,EAAE,OAAO9B,EAAE,CAAC,EAAE,CAAC;IAEnD,MAAM+B,cAAc,GAA+B,EAAE;IAErDR,OAAO,CAACS,OAAO,CAACC,IAAI,IAAG;MACrB,MAAMC,OAAO,GAAG,IAAI,CAACP,qBAAqB,CAACM,IAAI,CAAC;MAChDF,cAAc,CAACI,IAAI,CAACD,OAAO,CAAC;IAC9B,CAAC,CAAC;IAEF,OAAOpC,aAAa,CAACiC,cAAc,CAAC;EAEtC;EAAC,QAAAK,CAAA,G;qBA9DUlC,gBAAgB,EAAAmC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAhBvC,gBAAgB;IAAAwC,OAAA,EAAhBxC,gBAAgB,CAAAyC,IAAA;IAAAC,UAAA,EAFf;EAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}